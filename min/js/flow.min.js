var cH,cW,c=document.getElementById("c"),ctx=c.getContext("2d"),bgColor="#282741",animations=[],circles=[],clickH=c.parentNode?.parentNode,colorPicker=function(){var t=["#FFBE53","#ec407a","#0097a7","#282741"],e=0;return{next:function(){return e=e++<t.length-1?e:0,t[e]},current:function(){return t[e]}}}();function removeAnimation(t){var e=animations.indexOf(t);e>-1&&animations.splice(e,1)}function calcPageFillRadius(t,e){var n=Math.max(t-0,cW-t),i=Math.max(e-0,cH-e);return Math.sqrt(Math.pow(n,2)+Math.pow(i,2))}function addClickListeners(){$(clickH).on("touchstart",handleEvent),$(clickH).on("mousedown",handleEvent)}function handleEvent(t){t.touches&&(t.preventDefault(),t=t.touches[0]),t.stopPropagation();for(var e=colorPicker.current(),n=colorPicker.next(),i=calcPageFillRadius(t.pageX,t.pageY),a=Math.min(200,.4*cW),c=new Circle({x:t.pageX,y:t.pageY,r:0,fill:n}),o=window.anime({targets:c,r:i,duration:Math.max(i/2,750),easing:"easeOutQuart",complete:function(){bgColor=c.fill,removeAnimation(o)}}),r=new Circle({x:t.pageX,y:t.pageY,r:0,fill:e,stroke:{width:3,color:e},opacity:1}),l=anime({targets:r,r:a,opacity:0,easing:"easeOutExpo",duration:900,complete:removeAnimation}),s=[],u=0;u<32;u++){var d=new Circle({x:t.pageX,y:t.pageY,fill:e,r:anime.random(24,48)});s.push(d)}var m=anime({targets:s,x:function(t){return t.x+anime.random(a,-a)},y:function(t){return t.y+anime.random(1.15*a,1.15*-a)},r:0,easing:"easeOutExpo",duration:anime.random(1e3,1300),complete:removeAnimation});animations.push(o,l,m)}function extend(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}var Circle=function(t){extend(this,t)};Circle.prototype.draw=function(){ctx.globalAlpha=this.opacity||1,ctx.beginPath(),ctx.arc(this.x,this.y,this.r,0,2*Math.PI,!1),this.stroke&&(ctx.strokeStyle=this.stroke.color,ctx.lineWidth=this.stroke.width,ctx.stroke()),this.fill&&(ctx.fillStyle=this.fill,ctx.fill()),ctx.closePath(),ctx.globalAlpha=1};var animate=anime({duration:1/0,update:function(){ctx.fillStyle=bgColor,ctx.fillRect(0,0,cW,cH),animations.forEach((function(t){t.animatables.forEach((function(t){t.target.draw()}))}))}}),resizeCanvas=function(){cW=window.innerWidth,cH=window.innerHeight,c.width=cW*devicePixelRatio-10,c.height=cH*devicePixelRatio-10,ctx.scale(devicePixelRatio,devicePixelRatio)};function handleInactiveUser(){var t=startFauxClicking();function e(){clearInterval(t),$(clickH).off("mousedown",e),$(clickH).off("touchstart",e)}$(clickH).on("mousedown",e),$(clickH).on("touchstart",e)}function startFauxClicking(){return setInterval((function(){fauxClick(anime.random(.2*cW,.8*cW),anime.random(.2*cH,.8*cH))}),anime.random(1e3,3e3))}function fauxClick(t,e){var n=new Event("mousedown");n.pageX=t,n.pageY=e,clickH.dispatchEvent(n)}$((function(){resizeCanvas(),window.CP&&(window.CP.PenTimer.MAX_TIME_IN_LOOP_WO_EXIT=6e3),window.addEventListener("resize",resizeCanvas),addClickListeners(),startFauxClicking()}));